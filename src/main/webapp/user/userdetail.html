<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>基本资料页</title>
    <link rel="stylesheet" href="/layui/css/layui.css">
    <script src="/js/jquery-3.3.1.min.js"></script>
    <script src="/layui/layui.js"></script>
<!--    控制跳转-->
    <script>
        var currentUrl=window.location.href
        sessionStorage.setItem("currentUrl",currentUrl)
        if (sessionStorage.getItem("userId") == null) {
            window.location.href="/user/login.html"
        }
    </script>
    <script src="/js/user/user.js"></script>
</head>
<body>
<!--导航条-->
<div>
    <ul class="layui-nav" lay-filter="">
        <li class="layui-nav-item"><a href="/user/index.html">四川票务网</a></li>
        <li class="layui-nav-item layui-this"><a href="">关于我们</a></li>
        <li class="layui-nav-item"><a href="">帮助中心</a></li>
        <li class="layui-nav-item">
            <a href="javascript:;">问题建议</a>

        </li>
        <!--        <li class="layui-nav-item"><a href="">社区</a></li>-->
    </ul>
    <ul class="layui-nav layui-layout-right" id="ul01">

    </ul>
</div>

<hr class="layui-bg-gray">

<div class="layui-container">

    <div class="layui-row">
        <div class="layui-col-xs4 layui-col-sm4 layui-col-md4">
            <ul class="layui-nav layui-nav-tree" lay-filter="test">
                <!-- 侧边导航: <ul class="layui-nav layui-nav-tree layui-nav-side"> -->
                <li class="layui-nav-item layui-nav-itemed">
                    <a href="javascript:;">我的订单</a>
                    <dl class="layui-nav-child">
                        <dd><a href="javascript:;">火车票订单</a></dd>
                        <dd><a href="javascript:;">汽车票订单</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item layui-nav-itemed">
                    <a href="javascript:;">会员中心</a>
                    <dl class="layui-nav-child">
                        <dd><a href="">基本资料</a></dd>
                        <dd><a href="/user/usermodify.html">修改密码</a></dd>
                        <dd><a href="/user/passenger.html">常用乘车人</a></dd>
                    </dl>
                </li>

            </ul>
        </div>

        <div class="layui-col-xs8 layui-col-sm8 layui-col-md8">

            <div class="layui-row">
                <div class="layui-row" style="color: #1E9FFF;font-size: 24px">
                    基本资料
                </div>
                <div class="layui-col-xs4 layui-col-sm4 layui-col-md4">
                    <img class="headImg" src="https://www.tz12306.com/static/byWyy/img/personal_ico_head.png"
                         width="100px" height="100px" stfyle="float:left;">


                </div>

                <div class="layui-col-xs8 layui-col-sm8 layui-col-md8" style="height: 100px;line-height: 100px">
                    <span id="span01" style="color: #eb7350;font-size: 20px"></span>您好，欢迎登录四川票务网个人中心
                </div>
            </div>
            <hr class="layui-bg-gray">
            <div class="layui-row">
                <form class="layui-form" >
                    <div class="layui-form-item">
                        <label class="layui-form-label">用户名</label>
                        <div class="layui-input-block">
                            <input type="text" name="title" required lay-verify="required" readonly autocomplete="off"
                                   class="layui-input" id="username">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">真实姓名</label>
                        <div class="layui-input-block">
                            <input type="text" name="title" required lay-verify="required" autocomplete="off"
                                   class="layui-input" id="realname">
                        </div>
                    </div>


                    <div class="layui-form-item">
                        <label class="layui-form-label">单选框</label>
                        <div class="layui-input-block">
                            <input type="radio" name="sex" value="男" title="男">
                            <input type="radio" name="sex" value="女" title="女" checked>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">手机号</label>
                        <div class="layui-input-block">
                            <input type="text" name="title" required lay-verify="required" autocomplete="off"
                                   class="layui-input" id="telephone">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">身份证号</label>
                        <div class="layui-input-block">
                            <input type="text" name="title" required lay-verify="required" autocomplete="off"
                                   class="layui-input" id="userIdentity">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <button  type="button" style="color: #FFFFFF;background-color: #009688;width: 80px;height: 38px;border: none;" id="updatebut">修改个人资料</button>
                            <button  type="button" style="color: #FFFFFF;background-color: #009688;width: 80px;height: 38px;border: none;" id="sub">立即提交</button>
                        </div>
                    </div>
                </form>
            </div>


        </div>

    </div>


    <!--footer-->
    <div class="footer" style="text-align: center;position: fixed;bottom: 0px;left: 25%">
        <div class="copy-info">
            <p>
                <a href="https://www.scqckypw.com:443" title="">返回首页</a>&nbsp;|&nbsp; <a
                    href="https://www.scqckypw.com:443/help/abus.html" title="">关于我们</a>&nbsp;|&nbsp;
                <a href="https://www.scqckypw.com:443/help/buyTicket.html" title="">如何购票</a>&nbsp;|&nbsp; <span>服务电话：400-858-3030</span>
            </p>
            <p>版权所有：四川省交通运输厅道路运输管理局&nbsp;&nbsp;&nbsp;&nbsp;网站备案号：蜀ICP备05031914号&nbsp;&nbsp;<script
                    type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
            document.write(unescape("%3Cspan id='cnzz_stat_icon_1254367912'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s11.cnzz.com/z_stat.php%3Fid%3D1254367912%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
                <span id="cnzz_stat_icon_1254367912"><a href="https://www.cnzz.com/stat/website.php?web_id=1254367912"
                                                        target="_blank" title="站长统计"><img border="0" hspace="0"
                                                                                          vspace="0"
                                                                                          src="https://icon.cnzz.com/img/pic.gif"></a></span>
                <script src=" https://s11.cnzz.com/z_stat.php?id=1254367912&amp;show=pic"
                        type="text/javascript"></script>
                <script src="https://c.cnzz.com/core.php?web_id=1254367912&amp;show=pic&amp;t=z" charset="utf-8"
                        type="text/javascript"></script>
            </p>
        </div>
        <div class="copy-icon">
            <a href="http://www.cdnet110.com/" target="_blank" title=""><img
                    src="https://image.scqckypw.com/static/scqcp/images1/jc.jpg" alt=""></a>
        </div>


        <!--导航条-->
        <script>
            //注意：导航 依赖 element 模块，否则无法进行功能性操作
            layui.use('element', function () {
                var element = layui.element;

                //…
            });
        </script>
        <!--        中间表单元素-->
        <script>
            //Demo
            layui.use('form', function () {
                var form = layui.form;

                //监听提交
                form.on('submit(formDemo)', function (data) {
                    layer.msg(JSON.stringify(data.field));
                    return false;
                });
            });
        </script>


        <script>
            $(function () {

                // 用户信息查询
                $.ajax({
                    url: "/userSelect",   //请求路径
                    type: "POST",  //请求方式
                    asyns: true,   //true :异步 flase:同步   默认true
                    cache: "false",  //是否缓存  false关闭缓存  目的是避免部分浏览器缓存加载出错(IE))
                    datatype: "json",  //返回类型html, text , json
                    contentType: "application/json;charset=utf-8",
                    data: JSON.stringify({userId: sessionStorage.getItem("userId")}),//经过序列化的对象,
                    success: function (data) {
                        console.log("成功:" + JSON.stringify(data));
                        $("#username").val(data.username)
                        $("#realname").val(data.realname)
                        $("#telephone").val(data.telephone)
                        $("#userIdentity").val(data.userIdentity)

                        console.log("dfsdfd"+sessionStorage.getItem("username"))
                        $("#span01").html(sessionStorage.getItem("username")+'&nbsp')

                    },
                    error: function (data) {
                        //1响应失败 2 服务器中断 3网络中断 4 返回的不是json数据,无法解析
                        console.log(JSON.stringify(data));
                        console.log(data)
                        console.log("失败:");
                    }
                });

            })


            // 用户修改信息提交
            $("#sub").click(function () {

                $.ajax({
                    url: "/userupdate",   //请求路径
                    type: "POST",  //请求方式
                    asyns: true,   //true :异步 flase:同步   默认true
                    cache: "false",  //是否缓存  false关闭缓存  目的是避免部分浏览器缓存加载出错(IE))
                    datatype: "json",  //返回类型html, text , json
                    contentType: "application/json;charset=utf-8",
                    data: JSON.stringify({id:sessionStorage.getItem("userId"),realname: $("#realname").val(), telephone: $("#telephone").val(),userIdentity:$("#userIdentity").val()}),//经过序列化的对象,
                    success: function (data) {
                        console.log("成功:" + JSON.stringify(data));
                        alert(data.msg);


                    },
                    error: function (data) {
                        //1响应失败 2 服务器中断 3网络中断 4 返回的不是json数据,无法解析
                        console.log("失败:");
                        alert("失败");
                    }
                });
            })

            // 回车事件
            $(document).keydown(function(event){
                if(event.keyCode==13){
                    $("#sub").click();
                }
            });

        </script>
    </div>
</div>
</body>
</html>